<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<section class="website-container" id="Survey">
    <div class="row" id="workContent">
        <div class="col-xl-12">
            <div class="card">
                <textarea type="hidden" id="for_focus" style="height: 10px; width: 1px"></textarea>
                <input type="hidden" name="te" value="-1">
                <h5 class="card-header">Instructions&nbsp;<a data-toggle="collapse" href="#instructions"
                                                                         style="color:#0080ff;font-weight:normal;text-decoration: underline;">(expand/collapse)</a>
                </h5>
                <div id="instructions" class="collapse">
                    <div class="card-body">
                        <p><b><i>Task Info:</i></b> We are trying to understand image edit intent and the possible implications of image edits. To do this, we want to understand which parts of an edited image are important with regards to understanding the edit.</b>
                        </p>
                        <p style="margin-bottom: 0">You'll be given: an <span class="emph">image edit</span>, the source image, and an annotated version of the image edit ("Image with Boxes")</p>
                        <hr>
                        <p style="margin-bottom: 0"><b><i>High-level idea:</i></b></p>
                        <ul>
                            <li>Write captions that would answer the question under each heading.
                            <ul> <li>A caption should be a short, complete sentence. The beginning of each caption is provided.</li>
                                <li>Please write <span class="emph">1-3 captions per question, depending on how many you need to fully describe the edit.</span> Each caption should be different from the others.</li>
                                <li>For fairness, you'll be paid $1.50 per HIT, plus $0.14 for each caption written (~3.26 for a HIT with 9 captions). You'll get a bonus for highly rated work (see examples)</li>
                                <li>Each caption should be understood without looking at the original image(s).</li>
                                <li>Each caption should include a <span class="response">response</span> that anwers the question and also a <span class="rationale">rationale</span> that explictly refers to the image edit.</li>
</ul></li></ul>
<p style="margin-bottom: 0"><b><i>Step-by-step instructions:</i></b></p>
<ul>
        <li>1) Before typing, think about the edit - what is the intent of the edit? Take mental note of who the main persons are - who the edit is featuring.
        <li>2) Scroll down to the questions. Answer prompt 1 (required): What physically changed in the edit? </li>
            <li>3) Answer Prompt 2, <b>Is there a main person in this image (MP1)? (new! 3/26 Please fill this out whenever possible, even for background changes.)</b></li>
        <ul>
            <li>If yes: label the box that captures MP1 by scrolling back up to the image labeled “Edit with Boxes”. If the boxes are hard to distinguish, just give your best guess and move on. We won’t penalize attempts here :)</li>
            <li>If yes: answer Prompt 2 (part 1/2). As a reminder, please write both a <span class="response">response</span> and a <span class="rationale">rationale</span> for EACH caption.</li>
            <li>For example: MP1 would <span class="response">feel like the last person in an apocalyptic world</span> <span class="rationale">due to the fire and the fact that mp1 looks dressed for the end of the world.</span></li>
            <li>If yes: answer Prompt 2 (part 2/2) if it applies. You should talk about specifically what someone might believe about MP1 (examples in Examples). If this doesn't really apply to this main person, you can skip.</li>
        </ul>
        <li>
            4) Answer Prompt 3 and Prompt 4 in a similar manner (for different people).
        </li>
        <li>
            5) Answer Prompt 5 and Prompt 6, which will ask you general questions about the image. Try to refer to each MP here.
        </li>
        <li>
            6) Answer Prompt 7, if it applies. For this prompt, it's different from the "(part 2/2)" prompts in that you shouldn't focus on MP1/2/3, but rather, what you would generally take from the image as a whole. If there isn't anything you can be mislead by (e.g. it's just a funny edit), feel free to skip.
        </li>
        <li>
            7) Submit!
        </li>
        </li>     
        </ul>
        <b><i>Details:</i></b> (you do not need to read all of these! they might helpful if you get stuck :))
        <ul>
            <li>Including any world knowledge is OK. For example, it's fine to mention which of the public figures or places you recognize, and to use this infomation in your captions. The only time when we wouldn't want this is when we can use MP1/2/3 to describe a person instead. At the same time, you don't HAVE to know a public figure or location, especially if it is obscure or not obvious.</li>
            <li>It's OK if you click MP1/2/3 on accident. As long as you don't put in captions, the data won't get considered.</li>
            <li>Want to have these instructions open in a new tab? You can find a copy of them here. <a href="http://jeffda.com/links/research/part6.html">http://jeffda.com/links/research/part6.html</a></li>
            <li>Check out the examples! They should help with understanding what to do quickly.</li>
            <li><span class="emph">With simple edits, it's ok to be repetitive.</span> For example, if there is just one change, you can cite the same "rationale" for all captions. If the change is more complex, please try to use different captions.</li>
            <li>Do not refer explicitly to the images in your caption (e.g. saying “the image edit”, “the original edit”). The captions should make sense without needing to look at the images.</li>
            <li>Your captions between Prompts might be similar. This is ok! The only criteria is that it answers the related question.</li>
            <li>Try to refer to MP1, MP2, MP3, or other bounding boxes in the image via their tag (e.g. MP1) as often as you can.</li>
            <li>Please use the tags MP1, MP2, MP3 to refer to the people in the image. If the person you want to refer to is not a "main person", only then you can use a bounding box tag instead (e.g. 3).</li>
            <li>In the rare case that there are more than 3 main people in the image, pick 3 people to answer questions for.</li>
            <li>If something is hard to see (some images can be hectic), don't stress about labeling it. You only need to label the obvious people and obvious intent.</li>
            <li>Please use the tags MP1, MP2, MP3 instead of the bounding box tags (e.g. do not say "3") whenever possible.</li>
            <li>If it does not seem like the edited image is similar to the origonal image, please treat the prompt as "why would someone make an image edit like this?" rather than "why would someone edit the source image like this?". Please don't skip the HIT!</li>
            <li>If the boxes are hard to tell or there are many boxes, just give your best guess. This will be fixed soon :)</li>
            <li>You should use descriptors that <span class="emph">uniquely describe this scene.</span></li>
            <ul>
            <li><span class="do">Good:</span>"royal", "inquisitive", "inventive", "breathtaking"</li>
            <li><span class="dont">Bad:</span> "funny", "amusing", "would laugh", "confused"</li>
            </ul>
            <li>Here is a <span class="emph">list of good adjectives</span> to use: <a href="https://www.hoffmaninstitute.org/wp-content/uploads/Practices-FeelingsSensations.pdf">https://www.hoffmaninstitute.org/wp-content/uploads/Practices-FeelingsSensations.pdf</href></a></li>
            <li>Your captions should <span class="emph">refer to MP1/2/3</span>.</li>
            <ul>
            <li><span class="do">Do write: </span>Editor created this edit to show that MP1...</li>
            <li><span class="dont">Don’t write: </span>Editor created this edit to show that Obama...</li>
            </ul>
            <li>Please do not work on these HITs if you work at the University of Washington. <span class="smalltxt">(we have to include this rule in our HITs...)</span></li>
        </ul>
                    </div>
                </div>
            </div>

            <div class="card">
                <h5 class="card-header">Examples (updated! 2/17)&nbsp; &nbsp;<a data-toggle="collapse" href="#examples"
                                                                         style="color:#0080ff;font-weight:normal;text-decoration: underline;">(expand/collapse)</a>
                </h5>
                <div id="examples" class="collapse">
                    <div class="card-body">
                        <h4>Look at some full examples, with feedback: <a href="http://jeffda.com/links/research/examples_with_feedback.html">http://jeffda.com/links/research/examples_with_feedback.html</a></h4>
                        <!--EX-->
                        <div class="questionrowex">
                            Some Examples: (with <span class="response">response</span> and <span class="rationale">rationale</span> highlighted)
                            <ul>
                                <li>The important physical change in this image is that the gun MP1 is holding was turned into a banana.</li>
                                <li>This edit could potentially be used to <span class="response">make people take MP1 less seriously</span> for <span class="rationale">making his pose look like a dance.</span></li>
                                <li>This edit could potentially be used to <span class="response">make people laugh at MP1</span> <span class="rationale">by making them think of him participating in a music video.</span></li>
                                <li>Editor created this edit to <span class="response">trivialize MP1's work</span> <span class="rationale">by insinuating that he was a backup dancer for a pop musician.</span></li>
                                <li>Editor created this edit to <span class="response">make people laugh at MP1</span> <span class="rationale">for looking like a dancer instead of a leader.</span></li>
                                <li>MP1 would feel <span class="response">bewildered</span> <span class="rationale">as he knows he didn't dance in any music videos but was made to look like he was in one.</span></li>
                                <li>MP1 would feel <span class="response">self-conscious</span> <span class="rationale">because he wouldn't want people to think that he had participated in a dance music video.</span></li>
                                <li>Someone might mistakenly believe that MP1 <span class="response">was getting a rectal exam and didn't like it</span>, <span class="rationale">since the edit shows him in the doctors office getting a rectal exam.</span></li>
                                <li>In regards to the edit as a whole (not just MP1/2/3), this edit might mislead someone into believing that <span class="response">rectal exams are really painful and that doctors gather enjoyment from them</span>, <span class="rationale">since MP1 seems angry but the doctor seems happy when giving the exam</span>.</li>
                            </ul>
                        </div>
               
                    </div>

                </div>
            </div>

            <!--<div class="body">-->
                <!--<div class="img-container">-->
                    <!--<div id="drawing" class="drawing-class"></div>-->
                <!--</div>-->
                <!--<div class="row">-->
                    <!--<div id="globalbutton" class="col-lg-2 text-center" style="padding:0"></div>-->
                    <!--<div class="col-lg-10 buttonrow"></div>-->
                <!--</div>-->
            <!--</div>-->

            <div class="card questioncard" style="margin-top: 0.8rem;">

            <ul class="minipad"><li class="list-group-item">
                <span class="superemph">Important!</span> Requirements:
                <ul>
                <li>Your captions should include both a <span class="response">response</span> (that answers the question) and a <span class="rationale">rationale</span> (that explicitly refers to the what physically changed in the image edit), and your captions should be <span class="emph">applicable to this image edit only</span> - what makes image edit special! Detail is good.</li>
                <ul>
                <li>For example: This edit could potentially be used to <span class="response">promote prevention of air pollutants</span> <span class="rationale">because MP1 is surrounded by smoke and has a gas mask on.</span></li>
                </ul>
                <li>Your captions should refer to <span class="emph">MP1/2/3</span> (e.g. instead of "Obama", say "MP1")</li>
                </ul>

            </li></ul>

            <ul class="minipad"><li class="list-group-item">
                <span class="superemph">Changes (3/31)</span>
                <ul>
                <li>Bounding boxes are important (even more important than picking the correct main person). Please make sure a bounding box for MP1/2/3.</li>
                <li>New: you MUST fill out MP1/2/3, even for background changes. Exceptions are if there is no person, or in extreme cases.</li>
                <li>Please make sure to fill out the disinformation captions whenever it can apply to the given image (~50% of the time)</li>
                </ul>

            </li></ul>

            <div class="panel">
                <div class="card">
                    <h4>Image edit:</h4>
                    <img src="${image_e}" style="max-width: 500px; height: 100%; width: 100%;"/>
                     </div>
                     <h5 class="card-header">Titles, Edit with Boxes, Original Image &nbsp;<a data-toggle="collapse" href="#images" style="color:#0080ff;font-weight:normal;text-decoration: underline;">(expand/collapse)</a></h5>
                     <div id="images" class="collapse show">
                        <div class="row">
                            <div class="card col-md-12"><h5>Original Image title:</h5>${image_o_title}</div>
                        </div>
                        <div class="row">
                            <div class="card col-md-12"><h5>Edited Image title:</h5>${image_e_title}</div>
                        </div>
                        <div class="row">
                         <div class="card col-md-12"><h5>Edit with Boxes:</h5><img src="${image_b}" style="max-width: 500px; height: 100%; width: 100%;"/></div>
                        </div>
                        <div class="row">
                            <div class="card col-md-12"><h5>Original Image (if this is missing, it's ok!):</h5><img src="${image_o}" style="max-width: 500px; height: 100%; width: 100%;"/></div>
                        </div>
                     </div>

                <p></p>
                </div>
            </div>
            <ul class="minipad"><li class="list-group-item"><b>Prompt 1: </b> What physically changed in the image edit?</li></ul>
            <span class="example">Focus on the important change(s) only - how you would describe this edit in a sentence to someone who has never seen it before. Please use MP1/2/3 in this caption.</span>

            <div class="col-lg-12 questionbox">
                <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption</span></div>
                    <textarea class="form-control hitbox" rows="2" name="change" placeholder="" id="physical_change" onfocus="setCursorAtEnd(this)">The important physical change in this image is </textarea>
                </div>
            </div>
            <p></p>

                <ul class="minipad">
                        <li class="list-group-item"><b>Prompt 2: Is there a main person in this image (MP1)?</b>
                            <label class="btn-success"><input type="radio" name="mp1radio" value="y">Yes</label>
                            <label class="btn-warning"><input type="radio" name="mp1radio" value="n">No</label>
                        </li>
                    
                </ul>
                <div id="mp1radioy" style="display: none;">
                        <div class="questionrow">
                                <div class="row">
                                    <div class="col-lg-3 questionbox">
                                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Box Captured (From "Image with Boxes")</span></div>
                                            <textarea class="form-control hitbox" rows="1" name="mp1_box" id="mp1_box" placeholder="e.g. 3"></textarea>
                                        </div>
                                    </div>
                                    <label class="btn btn-sm btn-warning form-check-label">
                                        If the box is missing, DO NOT LABEL this MP. Focus on Main Persons with boxes.
                                    </label>
                                </div>
                            </div>
                <li class="list-group-item"><b>Prompt 2 (part 1/2): Write 1 - 3 captions that answer:</b> How might MP1 feel after seeing this edit? What physical part of the edit suggests this?</li>
                
                <span class="example"><i>For example:</i> MP1 would <span class="response">feel heroic</span> <span class="rationale">because it looks like they came out on the other side of a battle since everything is on fire around them and they look victorious.</span></span>
                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 1</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp1_feel_0" placeholder="Caption 1" id="mp1_feel_0" onfocus="setCursorAtEnd(this)">MP1 would </textarea>
                        </div>
                    </div>
                </div>
                </div>


                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 2</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp1_feel_1" placeholder="Caption 2" id="mp1_feel_1" onfocus="setCursorAtEnd(this)">MP1 would </textarea>
                        </div>
                    </div>
                </div>
                </div>

                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 3</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp1_feel_2" placeholder="Caption 3" id="mp1_feel_2" onfocus="setCursorAtEnd(this)">MP1 would </textarea>
                        </div>
                    </div>
                </div>
                </div>

                <li class="list-group-item"><b>Prompt 2 (part 2/2): Write 0 - 3 captions that answer:</b> How might this edit mislead someone to believe something untrue about MP1? What physical part of the edit suggests this?</li>
                
                <span class="example"><i>For example:</i> Someone might mistakenly believe that MP1 <span class="response">hates the company Verizon</span>, <span class="rationale">since they are holding the bill in a way that suggests anger and disgust.</span></span><br>
                <span class="example"><span class="emph">You only need to answer Prompt 2 (part 2/2) if it applies to the given edit.</span> Otherwise, you can skip.</span>

                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 1</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp1_mislead_0" placeholder="Caption 1" id="mp1_mislead_0" onfocus="setCursorAtEnd(this)">Someone might mistakenly believe that MP1 </textarea>
                        </div>
                    </div>
                </div>
                </div>


                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 2</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp1_mislead_1" placeholder="Caption 2" id="mp1_mislead_1" onfocus="setCursorAtEnd(this)">Someone might mistakenly believe that MP1 </textarea>
                        </div>
                    </div>
                </div>
                </div>

                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 3</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp1_mislead_2" placeholder="Caption 3" id="mp1_mislead_2" onfocus="setCursorAtEnd(this)">Someone might mistakenly believe that MP1 </textarea>
                        </div>
                    </div>
                </div>
                </div>
        </div>
                <p></p>

                <ul class="minipad">
                        <li class="list-group-item"><b>Prompt 3: Is there a second main person in this image (MP2)?</b>
                            <label class="btn-success"><input type="radio" name="mp2radio" value="ye">Yes</label>
                            <label class="btn-warning"><input type="radio" name="mp2radio" value="n">No</label>
                        </li>
                </ul>

                <div id="mp2radioye" style="display: none;">

            <div class="questionrow">
                    <div class="row">
                        <div class="col-lg-3 questionbox">
                            <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Box Captured (From "Image with Boxes")</span></div>
                                <textarea class="form-control hitbox" rows="1" name="mp2_box" id="mp2_box" placeholder="e.g. 3"></textarea>
                            </div>
                        </div>
                        <label class="btn btn-sm btn-warning form-check-label">
                            If the box is missing, DO NOT LABEL this MP. Focus on Main Persons with boxes.
                        </label>
                    </div>
                </div>

                <li class="list-group-item"><b>Prompt 3 (part 1/2): Write 1 - 3 captions that answer:</b> How might MP2 feel after seeing this edit? What physical part of the edit suggests this?</li>
                <span class="example"><i>For example:</i> MP2 would <span class="response">be confused</span> <span class="rationale">because he does not like anime and he does not play children card games.</span></span>
                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 1</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp2_feel_0" placeholder="Caption 1" id="mp2_feel_0" onfocus="setCursorAtEnd(this)">MP2 would </textarea>
                        </div>
                    </div>
                </div>
                </div>


                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 2</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp2_feel_1" placeholder="Caption 2" id="mp2_feel_1" onfocus="setCursorAtEnd(this)">MP2 would </textarea>
                        </div>
                    </div>
                </div>
                </div>

                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 3</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp2_feel_2" placeholder="Caption 3" id="mp2_feel_2" onfocus="setCursorAtEnd(this)">MP2 would </textarea>
                        </div>
                    </div>
                </div>
                </div>

                <li class="list-group-item"><b>Prompt 3 (part 2/2): Write 0 - 3 captions that answer:</b> How might this edit mislead someone to believe something untrue about MP2? What physical part of the edit suggests this?</li>
                
                <span class="example"><i>For example:</i> Someone might mistakenly believe that MP2 <span class="response">hates the company Verizon</span>, <span class="rationale">since they are holding the bill in a way that suggests anger and disgust.</span></span><br>
                <span class="example"><span class="emph">You only need to answer Prompt 3 (part 2/2) if it applies to the given edit.</span> Otherwise, you can skip.</span>

                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 1</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp2_mislead_0" placeholder="Caption 1" id="mp2_mislead_0" onfocus="setCursorAtEnd(this)">Someone might mistakenly believe that MP2 </textarea>
                        </div>
                    </div>
                </div>
                </div>


                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 2</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp2_mislead_1" placeholder="Caption 2" id="mp2_mislead_1" onfocus="setCursorAtEnd(this)">Someone might mistakenly believe that MP2 </textarea>
                        </div>
                    </div>
                </div>
                </div>

                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 3</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp2_mislead_2" placeholder="Caption 3" id="mp2_mislead_2" onfocus="setCursorAtEnd(this)">Someone might mistakenly believe that MP2 </textarea>
                        </div>
                    </div>
                </div>
                </div>

            </div>
                <p></p>

                <ul class="minipad">
                        <li class="list-group-item"><b>Prompt 4: Is there a third main person in this image (MP3)?</b>
                            <label class="btn-success"><input type="radio" name="mp3radio" value="yes">Yes</label>
                            <label class="btn-warning"><input type="radio" name="mp3radio" value="n">No</label>
                        </li>
                </ul>

                <div id="mp3radioyes" style="display: none;">

                <div class="questionrow">
                        <div class="row">
                            <div class="col-lg-3 questionbox">
                                <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Box Captured (From "Image with Boxes")</span></div>
                                    <textarea class="form-control hitbox" rows="1" name="mp3_box" id="mp3_box" placeholder="e.g. 3"></textarea>
                                </div>
                            </div>
                            <label class="btn btn-sm btn-warning form-check-label">
                                If the box is missing, DO NOT LABEL this MP. Focus on Main Persons with boxes.
                            </label>
                        </div>
                    </div>

                <li class="list-group-item"><b>Prompt 4 (part 1/2): Write 1 - 3 captions that answer:</b> How might MP3 feel after seeing this edit? What physical part of the edit suggests this?</li>
                <span class="example"><i>For example:</i> MP3 would <span class="response">feel proud</span> <span class="rationale">that the others were showing praise for their singing.</span></span>
                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 1</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp3_feel_0" placeholder="Caption 1" id="mp3_feel_0" onfocus="setCursorAtEnd(this)">MP3 would </textarea>
                        </div>
                    </div>
                </div>
                </div>

                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 2</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp3_feel_1" placeholder="Caption 2" id="mp3_feel_1" onfocus="setCursorAtEnd(this)">MP3 would </textarea>
                        </div>
                    </div>
                </div>
                </div>

                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 3</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp3_feel_2" placeholder="Caption 3" id="mp3_feel_2" onfocus="setCursorAtEnd(this)">MP3 would </textarea>
                        </div>
                    </div>
                </div>
                </div>

                <li class="list-group-item"><b>Prompt 4 (part 2/2): Write 0 - 3 captions that answer:</b> How might this edit mislead someone to believe something untrue about MP3? What physical part of the edit suggests this?</li>
                
                <span class="example"><i>For example:</i> Someone might mistakenly believe that MP3 <span class="response">hates the company Verizon</span>, <span class="rationale">since they are holding the bill in a way that suggests anger and disgust.</span></span><br>
                <span class="example"><span class="emph">You only need to answer Prompt 4 (part 2/2) if it applies to the given edit.</span> Otherwise, you can skip.</span>

                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 1</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp3_mislead_0" placeholder="Caption 1" id="mp3_mislead_0" onfocus="setCursorAtEnd(this)">Someone might mistakenly believe that MP3 </textarea>
                        </div>
                    </div>
                </div>
                </div>


                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 2</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp3_mislead_1" placeholder="Caption 2" id="mp3_mislead_1" onfocus="setCursorAtEnd(this)">Someone might mistakenly believe that MP3 </textarea>
                        </div>
                    </div>
                </div>
                </div>

                <div class="questionrow">
                <div class="row">
                    <div class="col-lg-12 questionbox">
                        <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 3</span></div>
                            <textarea class="form-control hitbox" rows="2" name="mp3_mislead_2" placeholder="Caption 3" id="mp3_mislead_2" onfocus="setCursorAtEnd(this)">Someone might mistakenly believe that MP3 </textarea>
                        </div>
                    </div>
                </div>
                </div>

                </div>

            <p></p>


            <ul class="minipad"><li class="list-group-item"><b>Prompt 5: Write 1 - 3 captions that answer:</b> Why did Editor create this edit? What physical part of the edit suggests this?</li></ul>
            <span class="example"><i>For example:</i> Editor created this edit to <span class="response">make MP1 appear to be a survivor of the end of the world</span> <span class="rationale">because his surroundings look like the apocalypse with all the fire and rubble.</span></span>
            <div class="questionrow">
            <div class="row">
                <div class="col-lg-12 questionbox">
                    <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 1</span></div>
                        <textarea class="form-control hitbox" rows="2" name="intent_0" placeholder="Caption 1" id="intent_0" onfocus="setCursorAtEnd(this)">Editor created this edit to </textarea>
                    </div>
                </div>
            </div>
            </div>


            <div class="questionrow">
            <div class="row">
                <div class="col-lg-12 questionbox">
                    <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 2</span></div>
                        <textarea class="form-control hitbox" rows="2" name="intent_1" placeholder="Caption 2" id="intent_1" onfocus="setCursorAtEnd(this)">Editor created this edit to </textarea>
                    </div>
                </div>
            </div>
            </div>

            <div class="questionrow">
            <div class="row">
                <div class="col-lg-12 questionbox">
                    <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 3</span></div>
                        <textarea class="form-control hitbox" rows="2" name="intent_2" placeholder="Caption 3" id="intent_2" onfocus="setCursorAtEnd(this)">Editor created this edit to </textarea>
                    </div>
                </div>
            </div>
            </div>

            <p></p>

            <ul class="minipad"><li class="list-group-item"><b>Prompt 6: Write 1 - 3 captions that answer:</b> What are the possible implications of this edit? What physical part of the edit suggests this?</li></ul>
            <span class="example"><i>For example:</i> This edit could potentially be used to <span class="response">make MP1 seem like a public hero</span> <span class="rationale">because it looks like MP1 is bravely walking out of fire and flames, similar to a vigilant firefighter.</span></span>
            <div class="questionrow">
            <div class="row">
                <div class="col-lg-12 questionbox">
                    <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 1</span></div>
                        <textarea class="form-control hitbox" rows="2" name="implications_0" placeholder="Caption 1" id="implications_0" onfocus="setCursorAtEnd(this)">This edit could potentially be used to </textarea>
                    </div>
                </div>
            </div>
            </div>


            <div class="questionrow">
            <div class="row">
                <div class="col-lg-12 questionbox">
                    <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 2</span></div>
                        <textarea class="form-control hitbox" rows="2" name="implications_1" placeholder="Caption 2" id="implications_1" onfocus="setCursorAtEnd(this)">This edit could potentially be used to </textarea>
                    </div>
                </div>
            </div>
            </div>

            <div class="questionrow">
            <div class="row">
                <div class="col-lg-12 questionbox">
                    <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 3</span></div>
                        <textarea class="form-control hitbox" rows="2" name="implications_2" placeholder="Caption 3" id="implications_2" onfocus="setCursorAtEnd(this)">This edit could potentially be used to </textarea>
                    </div>
                </div>
            </div>
            </div>

            <li class="list-group-item"><b>Prompt 7: Write 0 - 3 captions that answer:</b> How might this edit mislead the viewer? What physical part of the edit suggests this?</li>
                
            <span class="example"><i>For example:</i> In regards to the edit as a whole, this edit might mislead someone into believing that <span class="response">the company Verizon makes their customers mad</span>, <span class="rationale">since one of their customers seems to be very upset with his bill.</span></span><br>
            <span class="example"><span class="emph">You only need to answer Prompt 7 if it applies to the given edit.</span> Otherwise, you can skip.</span>

            <div class="questionrow">
            <div class="row">
                <div class="col-lg-12 questionbox">
                    <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 1</span></div>
                        <textarea class="form-control hitbox" rows="2" name="disinfo_0" placeholder="Caption 1" id="disinfo_0" onfocus="setCursorAtEnd(this)">In regards to the edit as a whole, this edit might mislead someone into believing that </textarea>
                    </div>
                </div>
            </div>
            </div>


            <div class="questionrow">
            <div class="row">
                <div class="col-lg-12 questionbox">
                    <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 2</span></div>
                        <textarea class="form-control hitbox" rows="2" name="disinfo_1" placeholder="Caption 2" id="disinfo_1" onfocus="setCursorAtEnd(this)">In regards to the edit as a whole, this edit might mislead someone into believing that </textarea>
                    </div>
                </div>
            </div>
            </div>

            <div class="questionrow">
            <div class="row">
                <div class="col-lg-12 questionbox">
                    <div class="input-group"><div class="input-group-prepend"><span class="input-group-text">Caption 3</span></div>
                        <textarea class="form-control hitbox" rows="2" name="disinfo_2" placeholder="Caption 3" id="disinfo_2" onfocus="setCursorAtEnd(this)">In regards to the edit as a whole, this edit might mislead someone into believing that </textarea>
                    </div>
                </div>
            </div>
            </div>

            

            <p></p>

            <!--
            <div class="card">
                    <h5 class="card-header">A note on wages (optional read) &nbsp;<a data-toggle="collapse" href="#wages"
                                                                             style="color:#0080ff;font-weight:normal;text-decoration: underline;">(expand/collapse)</a>
                    </h5>
                    <div id="wages" class="collapse">
                        <div class="card-body">
                            <p>We try to keep wages fair.</p>
                        </div>
                    </div>
                </div>
            -->

            <!--end here-->
            <div class="card">
                <h5 class="card-header">Optional feedback? &nbsp; &nbsp;<a data-toggle="collapse" href="#feedback"
                                                                           style="color:#0080ff;font-weight:normal;text-decoration: underline;">(expand/collapse)</a>
                </h5>
                <div id="feedback" class="collapse" style="margin:5px">
                    <div class="card-body">
                    <p>If anything about the HIT was unclear, please comment below. I'd like to make my HITs easier for future workers, so I really appreciate feedback! Note: no need to point out incorrect/missing detections here. </p>
                    <textarea class="form-control" rows="2" name="commentbox"></textarea>
                    </div>
                </div>
            </div>
            <div id="problems"> </div>
        </div>
    </div>
</section>


<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css"
      integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
<style type="text/css">

    .minipad {
        padding-left: 0rem;
    }
    .questionrow {
        border-bottom: 1px solid gray;
        padding-bottom: 2px;
        margin-bottom: 4px;
        margin-left: 0;
        margin-right: -5px;
    }
    .questionrowex {
        border-bottom: 1px solid gray;
        padding-bottom: 0.5rem;
        padding-top: 0.5rem;
        margin-bottom: 0.5rem;
        margin-left: 0;
        margin-right: -5px;
    }


    .panel {
        padding: 10px;
        margin-bottom: 3px;
        margin-top: 5px;
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 4px;
        -webkit-box-shadow: 0 1px 1px rgba(0,0,0,.05);
        box-shadow: 0 1px 1px rgba(0,0,0,.05);
        font-size: 11pt;
    }
    .table {
        margin-top: 0.2rem;
        margin-bottom: 0.2rem;
        background-color: #e6e6e633;
        border: 1px solid #ddd;
        border-radius: 4px;
        -webkit-box-shadow: 0 1px 1px rgba(0,0,0,.05);
        box-shadow: 0 1px 1px rgba(0,0,0,.05);
    }
    .table td, .table th {
        padding: 0.3rem;
    }

    .body {
        font-size:11pt;
    }

    .emph {
        background-color: #c3e6cb;
        color: #000;
        font-weight: bold;
    }

    .example {
        font-size:10pt;
    }

    .dont {
        background-color: #ffcccb;
        color: #000;
        font-weight: bold;
    }

    .do {
        background-color: #98fb98;
        color: #000;
        font-weight: bold;
    }

    .response {
        background-color: #a7a6ba;
        color: #000;
        font-weight: bold;
    }

    .rationale {
        background-color: #fed8b1;
        color: #000;
        font-weight: bold;
    }

    .superemph {
        background-color: #e6a0a5;
        color: #000;
        font-weight: bold;
    }

    .deemph {
        /*background-color: #f9f9f9;*/
        color: #141414;
        /*font-weight: lighter;*/
        font-size:10pt;
    }

    .row {
        margin-right: -5px;
        margin-left:-5px;
    }
    .questionbox {
        padding-right: 1px;
        padding-left: 1px;
    }
    .answerbox {
        padding-right: 1px;
        padding-left: 1px;
    }
    .input-group-text {
        padding: 3px;
        font-size: 0.8rem;
    }
    .card-header {
        padding: .25rem .5rem;
    }
    .card {
        margin-bottom: 3px;
    }
    .card-body {
        padding-top: .75rem;
        padding-bottom: 0;
    }
    .list-group-item {
        padding: .2rem .5rem;
        background-color: #e6e6e6;
    }

    .image-toggle {
        border-color: #000;
        white-space: normal;
        color: #fff;
    }

    .img-container {
      position: relative;
      display: inline-block;
    }
    .annotimage {
      display: block;
      max-width: 100%;
      height: auto;
      margin-top:0;
    }

    .drawing-class {
        height:0;
    }
    .segmentation {
      position: absolute;
      top: 0;
      left: 0;
      height:100%;
      width:100%;
    }

    .smalltxt {
        font-size:.6rem;
    }
    .form-check {
        padding-left:0;
        font-size:0.75rem;
    }
    .form-check-input {
        margin-left:0;
        position: relative;
    }

    .btn-sm {
        border-radius: .2rem;
        padding: 0.1rem 0.5rem;
        margin-bottom:0;
    }

    .website-container {
        padding-left: 50px;
        padding-right: 50px;
        padding-top: 10px;
        padding-bottom: 10px;
    }
    
    .col-xl-12 {
        padding:0;
    }


</style>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js"
        integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/2.6.5/svg.min.js" integrity="sha256-QvaFssiJCr71CxCZfYVWAXXGlwAqXbXerSdoW2t/Few=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.7/chroma.min.js"></script>
<script src="https://cdn.rawgit.com/internalfx/distinct-colors/3bbd4cc2/dist/distinct-colors.min.js"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<script>
    (function(){var e,t;e=this,t=function(){var r={startStopTimes:{},idleTimeoutMs:3e4,currentIdleTimeMs:0,checkStateRateMs:250,active:!1,idle:!1,currentPageName:"default-page-name",timeElapsedCallbacks:[],userLeftCallbacks:[],userReturnCallbacks:[],trackTimeOnElement:function(e){var t=document.getElementById(e);t&&(t.addEventListener("mouseover",function(){r.startTimer(e)}),t.addEventListener("mousemove",function(){r.startTimer(e)}),t.addEventListener("mouseleave",function(){r.stopTimer(e)}),t.addEventListener("keypress",function(){r.startTimer(e)}),t.addEventListener("focus",function(){r.startTimer(e)}))},getTimeOnElementInSeconds:function(e){var t=r.getTimeOnPageInSeconds(e);return t||0},startTimer:function(e,t){if(e||(e=r.currentPageName),void 0===r.startStopTimes[e])r.startStopTimes[e]=[];else{var n=r.startStopTimes[e],i=n[n.length-1];if(void 0!==i&&void 0===i.stopTime)return}r.startStopTimes[e].push({startTime:t||new Date,stopTime:void 0}),r.active=!0,r.idle=!1},stopAllTimers:function(){for(var e=Object.keys(r.startStopTimes),t=0;t<e.length;t++)r.stopTimer(e[t])},stopTimer:function(e,t){e||(e=r.currentPageName);var n=r.startStopTimes[e];void 0!==n&&0!==n.length&&(void 0===n[n.length-1].stopTime&&(n[n.length-1].stopTime=t||new Date),r.active=!1)},getTimeOnCurrentPageInSeconds:function(){return r.getTimeOnPageInSeconds(r.currentPageName)},getTimeOnPageInSeconds:function(e){var t=r.getTimeOnPageInMilliseconds(e);return void 0===t?void 0:t/1e3},getTimeOnCurrentPageInMilliseconds:function(){return r.getTimeOnPageInMilliseconds(r.currentPageName)},getTimeOnPageInMilliseconds:function(e){var t=r.startStopTimes[e];if(void 0!==t){for(var n=0,i=0;i<t.length;i++){var s=t[i].startTime,o=t[i].stopTime;void 0===o&&(o=new Date),n+=o-s}return Number(n)}},getTimeOnAllPagesInSeconds:function(){for(var e=[],t=Object.keys(r.startStopTimes),n=0;n<t.length;n++){var i=t[n],s=r.getTimeOnPageInSeconds(i);e.push({pageName:i,timeOnPage:s})}return e},setIdleDurationInSeconds:function(e){var t=parseFloat(e);if(!1!==isNaN(t))throw{name:"InvalidDurationException",message:"An invalid duration time ("+e+") was provided."};return r.idleTimeoutMs=1e3*e,this},setCurrentPageName:function(e){return r.currentPageName=e,this},resetRecordedPageTime:function(e){delete r.startStopTimes[e]},resetAllRecordedPageTimes:function(){for(var e=Object.keys(r.startStopTimes),t=0;t<e.length;t++)r.resetRecordedPageTime(e[t])},resetIdleCountdown:function(){r.idle&&r.triggerUserHasReturned(),r.idle=!1,r.currentIdleTimeMs=0},callWhenUserLeaves:function(e,t){this.userLeftCallbacks.push({callback:e,numberOfTimesToInvoke:t})},callWhenUserReturns:function(e,t){this.userReturnCallbacks.push({callback:e,numberOfTimesToInvoke:t})},triggerUserHasReturned:function(){if(!r.active)for(var e=0;e<this.userReturnCallbacks.length;e++){var t=this.userReturnCallbacks[e],n=t.numberOfTimesToInvoke;(isNaN(n)||void 0===n||0<n)&&(t.numberOfTimesToInvoke-=1,t.callback())}r.startTimer()},triggerUserHasLeftPage:function(){if(r.active)for(var e=0;e<this.userLeftCallbacks.length;e++){var t=this.userLeftCallbacks[e],n=t.numberOfTimesToInvoke;(isNaN(n)||void 0===n||0<n)&&(t.numberOfTimesToInvoke-=1,t.callback())}r.stopAllTimers()},callAfterTimeElapsedInSeconds:function(e,t){r.timeElapsedCallbacks.push({timeInSeconds:e,callback:t,pending:!0})},checkState:function(){for(var e=0;e<r.timeElapsedCallbacks.length;e++)r.timeElapsedCallbacks[e].pending&&r.getTimeOnCurrentPageInSeconds()>r.timeElapsedCallbacks[e].timeInSeconds&&(r.timeElapsedCallbacks[e].callback(),r.timeElapsedCallbacks[e].pending=!1);!1===r.idle&&r.currentIdleTimeMs>r.idleTimeoutMs?(r.idle=!0,r.triggerUserHasLeftPage()):r.currentIdleTimeMs+=r.checkStateRateMs},visibilityChangeEventName:void 0,hiddenPropName:void 0,listenForVisibilityEvents:function(){void 0!==document.hidden?(r.hiddenPropName="hidden",r.visibilityChangeEventName="visibilitychange"):void 0!==document.mozHidden?(r.hiddenPropName="mozHidden",r.visibilityChangeEventName="mozvisibilitychange"):void 0!==document.msHidden?(r.hiddenPropName="msHidden",r.visibilityChangeEventName="msvisibilitychange"):void 0!==document.webkitHidden&&(r.hiddenPropName="webkitHidden",r.visibilityChangeEventName="webkitvisibilitychange"),document.addEventListener(r.visibilityChangeEventName,function(){document[r.hiddenPropName]?r.triggerUserHasLeftPage():r.triggerUserHasReturned()},!1),window.addEventListener("blur",function(){r.triggerUserHasLeftPage()}),window.addEventListener("focus",function(){r.triggerUserHasReturned()}),document.addEventListener("mousemove",function(){r.resetIdleCountdown()}),document.addEventListener("keyup",function(){r.resetIdleCountdown()}),document.addEventListener("touchstart",function(){r.resetIdleCountdown()}),window.addEventListener("scroll",function(){r.resetIdleCountdown()}),setInterval(function(){r.checkState()},r.checkStateRateMs)},websocket:void 0,websocketHost:void 0,setUpWebsocket:function(e){if(window.WebSocket&&e){var t=e.websocketHost;try{r.websocket=new WebSocket(t),window.onbeforeunload=function(){r.sendCurrentTime(e.appId)},r.websocket.onopen=function(){r.sendInitWsRequest(e.appId)},r.websocket.onerror=function(e){console&&console.log("Error occurred in websocket connection: "+e)},r.websocket.onmessage=function(e){console&&console.log(e.data)}}catch(e){console&&console.error("Failed to connect to websocket host.  Error:"+e)}}return this},websocketSend:function(e){r.websocket.send(JSON.stringify(e))},sendCurrentTime:function(e){var t={type:"INSERT_TIME",appId:e,timeOnPageMs:r.getTimeOnCurrentPageInMilliseconds(),pageName:r.currentPageName};r.websocketSend(t)},sendInitWsRequest:function(e){var t={type:"INIT",appId:e};r.websocketSend(t)},initialize:function(e){var t=r.idleTimeoutMs||30,n=r.currentPageName||"default-page-name",i=void 0,s=void 0;e&&(t=e.idleTimeoutInSeconds||t,n=e.currentPageName||n,i=e.websocketOptions,s=e.initialStartTime),r.setIdleDurationInSeconds(t).setCurrentPageName(n).setUpWebsocket(i).listenForVisibilityEvents(),r.startTimer(void 0,s)}};return r},"undefined"!=typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],function(){return e.TimeMe=t()}):e.TimeMe=t()}).call(this);
</script>
<script>
    TimeMe.initialize({
        currentPageName: "task",
        idleTimeoutInSeconds: 30
    });
</script>
<script>// Set caret position easily in jQuery
        // Written by and Copyright of Luke Morton, 2011
        // Licensed under MIT
        (function ($) {
            // Behind the scenes method deals with browser
            // idiosyncrasies and such
            $.caretTo = function (el, index) {
                if (el.createTextRange) { 
                    var range = el.createTextRange(); 
                    range.move("character", index); 
                    range.select(); 
                } else if (el.selectionStart != null) { 
                    el.focus(); 
                    el.setSelectionRange(index, index); 
                }
            };
            
            // Another behind the scenes that collects the
            // current caret position for an element
            
            // TODO: Get working with Opera
            $.caretPos = function (el) {
                if ("selection" in document) {
                    var range = el.createTextRange();
                    try {
                        range.setEndPoint("EndToStart", document.selection.createRange());
                    } catch (e) {
                        // Catch IE failure here, return 0 like
                        // other browsers
                        return 0;
                    }
                    return range.text.length;
                } else if (el.selectionStart != null) {
                    return el.selectionStart;
                }
            };
        
            // The following methods are queued under fx for more
            // flexibility when combining with $.fn.delay() and
            // jQuery effects.
        
            // Set caret to a particular index
            $.fn.caret = function (index, offset) {
                if (typeof(index) === "undefined") {
                    return $.caretPos(this.get(0));
                }
                
                return this.queue(function (next) {
                    if (isNaN(index)) {
                        var i = $(this).val().indexOf(index);
                        
                        if (offset === true) {
                            i += index.length;
                        } else if (typeof(offset) !== "undefined") {
                            i += offset;
                        }
                        
                        $.caretTo(this, i);
                    } else {
                        $.caretTo(this, index);
                    }
                    
                    next();
                });
            };
        
            // Set caret to beginning of an element
            $.fn.caretToStart = function () {
                return this.caret(0);
            };
        
            // Set caret to the end of an element
            $.fn.caretToEnd = function () {
                return this.queue(function (next) {
                    $.caretTo(this, $(this).val().length);
                    next();
                });
            };
        }(jQuery));</script>

<script>

$(document).ready(function() {
    $("input[name$='mp1radio']").click(function() {
        var test = $(this).val();

        $("div.desc").hide();
        $("#mp1radio" + test).show();
    });
});
</script>
<script>
    $(document).ready(function() {
        $("input[name$='mp2radio']").click(function() {
            var test = $(this).val();
    
            $("div.desc").hide();
            $("#mp2radio" + test).show();
        });
    });
    </script>
<script>
$('#mp1_feel_0').caretToEnd();
$('#mp1_feel_1').caretToEnd();
$('#mp1_feel_2').caretToEnd();
$('#mp2_feel_0').caretToEnd();
$('#mp2_feel_1').caretToEnd();
$('#mp2_feel_2').caretToEnd();
$('#mp3_feel_0').caretToEnd();
$('#mp3_feel_1').caretToEnd();
$('#mp3_feel_2').caretToEnd();
$('#mp1_mislead_0').caretToEnd();
$('#mp1_mislead_1').caretToEnd();
$('#mp1_mislead_2').caretToEnd();
$('#mp2_mislead_0').caretToEnd();
$('#mp2_mislead_1').caretToEnd();
$('#mp2_mislead_2').caretToEnd();
$('#mp3_mislead_0').caretToEnd();
$('#mp3_mislead_1').caretToEnd();
$('#mp3_mislead_2').caretToEnd();
$('#intent_0').caretToEnd();
$('#intent_1').caretToEnd();
$('#intent_2').caretToEnd();
$('#implications_0').caretToEnd();
$('#implications_1').caretToEnd();
$('#implications_2').caretToEnd();
$('#disinfo_0').caretToEnd();
$('#disinfo_1').caretToEnd();
$('#disinfo_2').caretToEnd();
$('#for_focus').caretToEnd();
</script>
<script>
$(document).ready(function() {
    $("input[name$='mp3radio']").click(function() {
        var test = $(this).val();

        $("div.desc").hide();
        $("#mp3radio" + test).show();
    });
});
</script>
<script>
const FONTSIZE=25;

function flattenPoints(points) {
    const scaledPoints = [];
    for(let i=0; i < points.length; i++) {
        scaledPoints.push(points[i][0]);
        scaledPoints.push(points[i][1]);
    }
    return scaledPoints
}

function drawSegmentation(name, box, segm, color, width, height) {
    const draw = SVG('drawing').viewbox(0, 0, width, height);
    draw.addClass('segmentation');
    for (let i=0; i < segm.length; i++) {
        draw.polygon(flattenPoints(segm[i])).fill({color: color.brighten(2).hex(), opacity: 0.3}).stroke({opacity:0.5, width:2, color:color.darken(2).hex()});
    }
    draw.rect(box[2]-box[0], box[3]-box[1]).move(box[0],box[1]).fill({opacity: 0}).stroke({opacity: 0.8, width: 5, color:color.hex()});

    // const group = draw.group();
    const color2use = '#000';
    const topY = box[1]-FONTSIZE-7 > 0 ? box[1]-FONTSIZE-7 : box[1]-3;

    const mytext = draw.text(name).move(box[0]+2, topY).font({family: 'Helvetica', size: FONTSIZE, weight:500}).fill(color2use);
    // console.log(draw);
    // console.log(mytext);
    // const thebox = mytext.rbox(draw);
    const thebox = mytext.bbox();
    draw.rect(thebox.w+4, thebox.h+4).move(thebox.x, thebox.y-2).fill({color: color.brighten(2).hex(), opacity: 0.8}).stroke({opacity:0.8, width:3, color:color.hex()}).backward();
    return draw;
}

function det_match(text, dets) {
    // Get the detections that are good
    var matches = text.match(/(\d+|everyone)/gi);
    if (matches === null) {
        return [];
    }
    matches = matches.filter(function (x) {
        return (x === "everyone") || (Number(x) <= dets.length)
    });
    return matches;
}

function det_sub(text, dets) {
    return text.replace(/(\d+|everyone)/gi, function(x) {
        if ((x === "everyone") || (Number(x) <= dets.length)) {
            return '';
        } else {
            return x;
        }
    });
}

function setCursorAtEnd(node){
    setTimeout(function(){
         setCursor(node,node.value.length);
    },10);
}

function count_corefs(dets) {
    // Make sure there are enough
    let numCorefs = 0;
    $('.hitbox').each(function() {
        let text = $(this).val();
        numCorefs += det_match(text, dets).length;
    });
    return numCorefs;
}

function onlyUnique(value, index, self) {
    return self.indexOf(value) === index;
}

function find_syntax_mistakes(dets) {
    // Try to find syntax errors
    let mistakes = {};
    $('.hitbox').each(function() {

        let name = $(this).attr('name')[0].toUpperCase() + (Number($(this).attr('name')[1]) + 1);
        let text = $(this).val();
        let detMatchObj = det_match(text, dets);
        let text0 = det_sub(text, dets);

        // Find pronouns in the beginning
        let pronouns = null;
        if ((name[0] === "F") && (detMatchObj.length === 0)) {
            pronouns = text0.match(/\W(he|she|him|her|his|hers)\W/gi);
        }

        // Count anything in brackets
        let brackets = text0.match(/(\[.+?\])/g);
        let text1 = text0.replace(/(\[.+?\])/g, '');

        // Count things in parentheses
        let parens = text1.match(/(\(.+?\))/g);
        let text2 = text1.replace(/(\(.+?\))/g, '');

        // Count numbers less than 100
        let numbers = text2.match(/\b([0-9]|[1-9][0-9])\b/g);
        let text3 = text2.replace(/\b([0-9]|[1-9][0-9])\b/g, '');

        // Count weird characters
        let weirdchars = text3.match(/([^A-Za-z0-9 \.,\?\'!\-\;\:])/g);
        if (weirdchars !== null) {
            weirdchars = weirdchars.filter(onlyUnique);
        }

        let text4 = text3.replace(/([^A-Za-z \.,\?!\-\;\:])/g, '');

        if ((text4 !== text0) || (pronouns !== null)) {
            mistakes[name] = {
                brackets: brackets,
                parens: parens,
                numbers: numbers,
                weirdchars: weirdchars,
                pronouns: pronouns,
            };
        }
    });
    return mistakes;
}


const lengths_required = {
    F: 3,
};

function ensure_long_enough() {
    // Return a dict that's {row_num: is_problem, problems={field_length, needed_length}}
    // The problems are either with the text length, or if nothing was checked for q/a/r.
    var rowStatus = {};
    var num_rows = 5;

    for(let i=0; i < num_rows; i++) {
        rowStatus[i] = {is_problem: false, problems: []};
    }

    $('.hitbox').each(function() {
        let text_split = $(this).val().split(/\s+/).filter(Boolean);
        let row_number = Number($(this).attr('name')[1]);
        let name = $(this).attr('name')[0].toUpperCase() + (row_number+1);
        if (lengths_required[name[0]] > text_split.length) {
            rowStatus[row_number]['is_problem'] = true;
            rowStatus[row_number]['problems'].push({
                name: name,
                length: text_split.length,
                length_needed: lengths_required[name[0]],
            });
        }
    });

    // If there's a source
    var is_checked = {};
    $('.answerbox > .form-check-label > input:checked').each(function() {
        is_checked[$(this).attr('name')] = true;
    });
    for(let i=0; i < num_rows; i++) {
        if (!(('src' + i) in is_checked)) {
            rowStatus[i]['is_problem'] = true;
            rowStatus[i]['problems'].push({name: 'S' + (i+1), unchecked:true});
        }
    }
    // If Q2-5 rows are consistently a problem then remove them.
    for (let i=1; i < num_rows; i++) {
        if (rowStatus[i]['is_problem'] && (rowStatus[i]['problems'].length >= 2)) {
            delete rowStatus[i];
        }
    }
    // console.log("ISCHECKED");
    // console.log(is_checked);
    // console.log("ROWSTATUS");
    // console.log(rowStatus);

    return rowStatus;
}

function addAlert(msg) {
    let myAlert = $('<div class="alert alert-danger">');
    myAlert.append(msg);
    $('#problems').append(myAlert);
}

function addWarning(msg) {
    let myAlert = $('<div class="alert alert-warning">');
    myAlert.append(msg);
    $('#problems').append(myAlert);
}

validated_good = false;

function validate() {
    var isgood=true;
    var includeMP=false;
    var filledMP=false;
    $('#problems').empty();


    var dims = ["mp1_feel", "mp2_feel", "mp3_feel", "intent", "implications", "disinfo"]
    var idxs = ["0", "1", "2"]
    for (var i = 0; i < dims.length; i++) {
        for (var j = 0; j < idxs.length; j++) {
            var len = $("#" + dims[i] + "_" + idxs[j]).val().length
            var textval = $("#" + dims[i] + "_" + idxs[j]).val()
            if (len < 90 && i != 5) {
                if (i == 0 || i == 1 || i == 2) { // mp1/2/3
                    if (len < 45) {
                        continue;
                    }
                    filledMP = true;
                } else {
                    if (len < 50) {
                        continue;
                    }
                }
                addAlert("Prompt " + (i + 1).toString() + ", caption " + (j + 1).toString() + " is a little shorter than we would expect (at least " + (90 - len) + " more characters). Please make sure you included a rationale.");
                isgood=false;
            }
            if (i == 3 || i == 4) {
                if (textval.includes("MP1") || textval.includes("MP2") || textval.includes("MP3") || textval.includes("mp1") || textval.includes("mp2") || textval.includes("mp3")) {
                    includeMP = true;
                }
            }
            if (i == 5) {
                if (textval.includes("MP1") || textval.includes("MP2") || textval.includes("MP3") || textval.includes("mp1") || textval.includes("mp2") || textval.includes("mp3")) {
                    discludeMP = false;
                }
            }
        }
    }

    var invalidBox = false;
    var box_ids = ["mp1_box", "mp2_box", "mp3_box"]
    for (var i = 0; i < box_ids.length; i++) {
        var boxval = $("#" + box_ids[i] + "_" + idxs[j]).val()
        if (isNaN(boxval) && !(boxval == '{}' || boxval == "")) {
            invalidBox = true
        }
    }

    if (!includeMP) {
        addWarning("Remember to make sure to refer to MP1, MP2 and MP3 whenever possible in your captions.");
    }

    if (!isgood) {
        addAlert("Please make sure *all* your captions include a rationale, not just the ones listed above! I'll be reading the text of every HIT, and we look for a rationale in every caption as criteria for a high-quality HIT.")
    }

    if (!filledMP) {
       addAlert("(new! 3/31) Please fill out at least 1 main person connected to a bounding box whenever possible (this is a just in case reminder!).")
    }

    // if (invalidBox) {
    //    addAlert("(new! 3/26) The box you use to label MP1/2/3 must be a number (e.g. 3). Please try your best to change the value to a single number, or if impossible, do not label that Main Person.")
    // }

    addWarning("As long as you understand the warnings, you can submit by pressing Submit again.")

    return (filledMP && isgood) || validated_good;
}

$( document ).ready(function() {
    $.getJSON('https://s3-us-west-2.amazonaws.com/ai2-rowanz/vcr1images/movieclips_Mountains_of_the_Moon/NbhfbT2aU0k@10.json?sigh=' + Math.floor(Math.random() * 1000), function (data) {
        // Show or hide on hover
        // const palette = new DistinctColors({count: data.names.length, lightMin: 25});
        //
        // for (let i = 0; i < data.names.length; i++) {
        //     let bgcolor = palette[i].darker().hex();
        //     let bgcolorHighlight = palette[i].brighten().hex();
        //     let name_i = (i+1).toString() + " (" + data.names[i] + ")";
        //
        //     let mybutton = $('<button type="button" class="btn image-toggle active" style="background-color: ' + bgcolorHighlight + '; color: #000" data-toggle="button" aria-pressed="true">').text(name_i);
        //     let draw = drawSegmentation(name_i, data.boxes[i], data.segms[i], palette[i], data.width, data.height);
        //     mybutton.on('click', function () {
        //         if (mybutton.attr('aria-pressed') === 'true') {
        //             mybutton.css({backgroundColor: bgcolor, color: '#fff'});
        //             draw.attr('opacity', 0);
        //         } else {
        //             draw.attr('opacity', 1);
        //             mybutton.css({backgroundColor: bgcolorHighlight, color: '#000'});
        //         }
        //     });
        //
        //     mybutton.hover(function () {
        //         if (mybutton.attr('aria-pressed') === 'true') {
        //             mybutton.css({backgroundColor: bgcolor, color: '#fff'});
        //         } else {
        //             mybutton.css({backgroundColor: bgcolorHighlight, color: '#000'});
        //         }
        //     }, function () {
        //         if (mybutton.attr('aria-pressed') === 'true') {
        //             mybutton.css({backgroundColor: bgcolorHighlight, color: '#000'});
        //         } else {
        //             mybutton.css({backgroundColor: bgcolor, color: '#fff'});
        //         }
        //     });
        //     $('.buttonrow').append(mybutton);
        // }
        // let hideall = $('<button type="button" class="btn btn-outline-dark">').text('hide all').appendTo('#globalbutton');
        // hideall.on('click', function () {
        //     $('.buttonrow > button.active').click();
        // });
        //
        // let showall = $('<button type="button" class="btn btn-outline-dark">').text('show all').appendTo('#globalbutton');
        // showall.on('click', function () {
        //     $('.buttonrow > button:not(.active)').click();
        // });
        $('#submitButton').on('click', function () {
            try {
                $('input[name=te]').attr('value', TimeMe.getTimeOnCurrentPageInSeconds());
            } catch {
            }
            var value = validate();
            validated_good = true;
            return value;
        });
    });

    // Unfortunately I had to get rid of this script because it was causing some workers problems. Sorry about that :(
    // $('[name="q0"]').focus().click();
});
</script>
